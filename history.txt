#V2
SELECT id, name, created_at, updated_at FROM document WHERE case_id = 'case:a66381db' LIMIT 5;
SELECT id, name, case_id, created_at, updated_at FROM document LIMIT 3;
INFO FOR DB;
SELECT id, name, created_at, updated_at FROM document LIMIT 3;
SELECT id, name, source_type, created_at, updated_at FROM document WHERE source_type = 'linked' LIMIT 5;
-- Migration 002: Academic Schema for Legal Study Assistant
-- Description: Adds support for academic organization (sessions, courses, modules)
-- Date: 2024-12-12
-- Author: Legal Study Assistant Migration
-- =========================================
-- 1. CREATE SESSION TABLE
-- =========================================
-- Sessions acad√©miques (ex: "Automne 2024", "Hiver 2025")
DEFINE TABLE session SCHEMAFULL;
-- Fields
DEFINE FIELD title ON session TYPE string
SELECT id, title, course_code, professor, credits, type_transaction, nom_dossier FROM course;
SELECT * FROM course;
INFO FOR DB;
SELECT * FROM case;
SELECT COUNT() FROM case GROUP ALL;
SELECT * FROM document WHERE string::starts_with(string::lowercase(course_id), 'case:');
-- Delete all records from the case table
DELETE FROM case;
-- Verify deletion
SELECT COUNT() FROM case GROUP ALL;
SELECT * FROM summary;
SELECT * FROM analysis_result;
-- Remove the case table completely
REMOVE TABLE case;
-- Verify tables
INFO FOR DB;
SELECT id, title, course_code, professor FROM course;
SELECT count() as total FROM embedding WHERE case_id = 'course:938c0203' GROUP ALL;
SELECT id, nom_fichier, indexed, source_type, type_fichier FROM document 
SELECT id, nom_fichier, indexed, source_type, type_fichier FROM document WHERE course_id = 'course:4de2c06d' AND source_type = 'linked' LIMIT 5;
SELECT id, nom_fichier, source_type, type_fichier, file_path FROM document WHERE course_id = 'course:4de2c06d' LIMIT 10;
SELECT * FROM course WHERE id = 'course:4de2c06d';
SELECT COUNT() as total FROM document GROUP ALL;
SELECT * FROM course WHERE id = 'course:4de2c06d';
SELECT id, nom_fichier, indexed, source_type, type_fichier FROM document WHERE course_id = 'course:4de2c06d' AND source_type = 'linked' LIMIT 5;
SELECT COUNT() as total FROM embedding WHERE document_id CONTAINS 'document:';
SELECT id, nom_fichier, texte_extrait FROM document WHERE id = 'document:12c2ec60';
SELECT * FROM document LIMIT 2;
SELECT COUNT() as total_embeddings FROM embedding;
SELECT * FROM course:4de2c06d;
UPDATE course:4de2c06d MERGE { pinned: true }; SELECT * FROM course:4de2c06d;
UPDATE course:4de2c06d MERGE { pinned: true };
UPDATE course:4de2c06d SET pinned = true; SELECT * FROM course:4de2c06d;
INFO FOR TABLE course;
DEFINE FIELD pinned ON course TYPE bool DEFAULT false PERMISSIONS FULL;
UPDATE course:4de2c06d SET pinned = true; SELECT pinned FROM course:4de2c06d;
SELECT * FROM course:4de2c06d;
SELECT * FROM course WHERE id CONTAINS '4de2c06d';
SELECT id, title, course_code, course_name FROM course LIMIT 10;
SELECT id, title, course_code, course_name FROM course WHERE title CONTAINS 'Introduction';
-- ============================================================================
-- Migration 004: Add pinned field to course table
-- ============================================================================
-- Adds a boolean field to allow users to pin/unpin courses
-- Pinned courses appear first in the list
-- ============================================================================
-- Add pinned field to course table
DEFINE FIELD pinned ON course TYPE bool DEFAULT false PERMISSIONS FULL;
-- Migration complete!
INFO FOR TABLE course;
SELECT id, session_id FROM course LIMIT 5;
SELECT * FROM course LIMIT 1;
REMOVE FIELD session_id ON TABLE course;
SELECT id, nom_fichier, source_type FROM document WHERE source_type = 'linked' LIMIT 5;
SELECT id, nom_fichier, course_id, source_type FROM document WHERE course_id CONTAINS 'CAIJ' LIMIT 10;
SELECT id, title FROM course LIMIT 10;
SELECT id, nom_fichier, course_id, source_type FROM document WHERE source_type = 'linked' LIMIT 10;
SELECT id, nom_fichier, source_type, linked_source FROM document LIMIT 5;
INFO FOR DB;
INFO FOR ROOT;
SELECT * FROM user LIMIT 5;
INFO FOR DB;
SELECT * FROM course LIMIT 3;
SELECT count() AS count FROM user GROUP ALL;
SELECT count() AS count FROM course GROUP ALL;
SELECT count() AS count FROM user GROUP ALL;
SELECT count() AS count FROM course GROUP ALL;
