#V2
SELECT count() AS count FROM course GROUP ALL;
SELECT * FROM course WHERE name CONTAINS "DRT-1151G" OR name CONTAINS "DRT1151";
SELECT * FROM course;
-- Définition de la table flashcard_deck
DEFINE TABLE flashcard_deck SCHEMAFULL;
DEFINE FIELD course_id ON flashcard_deck TYPE string;
DEFINE FIELD name ON flashcard_deck TYPE string;
DEFINE FIELD source_documents ON flashcard_deck TYPE array;
DEFINE FIELD card_types ON flashcard_deck TYPE array;
DEFINE FIELD card_count_requested ON flashcard_deck TYPE int DEFAULT 50;
DEFINE FIELD created_at ON flashcard_deck TYPE datetime DEFAULT time::now();
DEFINE FIELD last_studied ON flashcard_deck TYPE option<datetime>;
-- Index pour recherche par cours
DEFINE INDEX idx_flashcard_deck_course ON flashcard_deck FIELDS course_id;
-- Définition de la table flashcard
DEFINE TABLE flashcard SCHEMAFULL;
DEFINE FIELD deck_id ON flashcard TYPE string;
DEFINE FIELD document_id ON flashcard TYPE string;
DEFINE FIELD card_type ON flashcard TYPE string;
DEFINE FIELD front ON flashcard TYPE string;
DEFINE FIELD back ON flashcard TYPE string;
DEFINE FIELD source_excerpt ON flashcard TYPE option<string>;
DEFINE FIELD source_location ON flashcard TYPE option<string>;
DEFINE FIELD status ON flashcard TYPE string DEFAULT "new";
DEFINE FIELD review_count ON flashcard TYPE int DEFAULT 0;
DEFINE FIELD last_reviewed ON flashcard TYPE option<datetime>;
DEFINE FIELD created_at ON flashcard TYPE datetime DEFAULT time::now();
-- Index pour recherche par deck
DEFINE INDEX idx_flashcard_deck ON flashcard FIELDS deck_id;
-- Index pour recherche par statut (pour session de révision)
DEFINE INDEX idx_flashcard_status ON flashcard FIELDS deck_id, status;
-- Vérification
INFO FOR TABLE flashcard_deck;
INFO FOR TABLE flashcard;
SELECT id, name, course_id, created_at FROM flashcard_deck ORDER BY created_at DESC;
SELECT * FROM flashcard_deck LIMIT 3;
SELECT * FROM flashcard LIMIT 5;
SELECT * FROM flashcard WHERE deck_id = "flashcard_deck:60ad6f56";
DELETE flashcard WHERE deck_id = "flashcard_deck:60ad6f56";
SELECT id, name, card_count_requested, source_documents FROM flashcard_deck WHERE name = "Modules 1 à 3";
SELECT id, front, back, card_type FROM flashcard WHERE deck_id CONTAINS "Modules";
SELECT id, front, back, card_type FROM flashcard WHERE deck_id = "flashcard_deck:d93c545c";
DELETE flashcard WHERE deck_id = "flashcard_deck:d93c545c";
SELECT id, card_type, front, back FROM flashcard WHERE deck_id = "flashcard_deck:d93c545c";
SELECT count() as total FROM flashcard WHERE deck_id = "flashcard_deck:d93c545c" GROUP ALL;
SELECT * FROM module LIMIT 10;
SELECT * FROM module WHERE id = type::thing('module', '48053518');
SELECT id, name FROM module;
SELECT * FROM module:48053518;
LET $record_id = '48053518';
SELECT * FROM module WHERE id = type::thing('module', $record_id);
LET $full_id = 'module:48053518';
SELECT * FROM module WHERE id = $full_id;
SELECT id, meta::id(id) as raw_id FROM module WHERE name = 'Module 7';
SELECT * FROM module WHERE id = type::thing('module', 48053518);
SELECT id, filename, course_id, created_at FROM document WHERE filename CONTAINS 'CanLII' ORDER BY filename;
SELECT id, filename, course_id, created_at FROM document ORDER BY filename LIMIT 50;
INFO FOR DB;
SELECT id, filename, course_id, created_at FROM document ORDER BY filename LIMIT 50;
SELECT id, filename, course_id FROM document WHERE filename IS NOT NONE ORDER BY filename;
SELECT * FROM document LIMIT 3;
SELECT id, nom_fichier, course_id FROM document WHERE nom_fichier CONTAINS 'CanLII';
SELECT id, nom_fichier, course_id, source_type FROM document WHERE nom_fichier = '2000CanLIIDocs325.md';
SELECT id, nom_fichier, course_id, module_id FROM document WHERE nom_fichier IS NOT NONE ORDER BY nom_fichier LIMIT 30;
SELECT nom_fichier, course_id, array::group(id) AS ids, count() AS cnt FROM document WHERE nom_fichier IS NOT NONE GROUP BY nom_fichier, course_id;
SELECT id FROM course;
SELECT course_id, case_id FROM document WHERE nom_fichier IS NOT NONE GROUP BY course_id, case_id;
SELECT nom_fichier, case_id, course_id, array::group(id) AS ids, count() AS cnt FROM document WHERE nom_fichier IS NOT NONE GROUP BY nom_fichier, case_id, course_id;
SELECT * FROM document:67df4951;
SELECT * FROM document:76e07952;
DELETE document:76e07952;
SELECT count() FROM document WHERE nom_fichier IS NONE;
SELECT * FROM document WHERE nom_fichier IS NONE;
DELETE document:0106c517;
SELECT count() FROM user GROUP ALL
-- Migration: Create audio_summary table for audio summaries of course documents
-- Purpose: Store audio summary metadata, scripts, and generated audio file paths
-- Create audio_summary table
DEFINE TABLE audio_summary SCHEMAFULL;
-- Fields
DEFINE FIELD course_id ON audio_summary TYPE string;
DEFINE FIELD name ON audio_summary TYPE string;
DEFINE FIELD source_documents ON audio_summary TYPE array;
DEFINE FIELD status ON audio_summary TYPE string DEFAULT "pending";
DEFINE FIELD script_path ON audio_summary TYPE option<string>;
DEFINE FIELD audio_path ON audio_summary TYPE option<string>;
DEFINE FIELD script_data ON audio_summary TYPE option<object>;
DEFINE FIELD voice_config ON audio_summary TYPE object;
DEFINE FIELD estimated_duration_seconds ON audio_summary TYPE float DEFAULT 0.0;
DEFINE FIELD actual_duration_seconds ON audio_summary TYPE option<float>;
DEFINE FIELD section_count ON audio_summary TYPE int DEFAULT 0;
DEFINE FIELD error_message ON audio_summary TYPE option<string>;
DEFINE FIELD model_id ON audio_summary TYPE option<string>;
DEFINE FIELD created_at ON audio_summary TYPE datetime;
DEFINE FIELD updated_at ON audio_summary TYPE option<datetime>;
-- Indexes
DEFINE INDEX idx_audio_summary_course_id ON audio_summary FIELDS course_id;
DEFINE INDEX idx_audio_summary_status ON audio_summary FIELDS status;
DEFINE INDEX idx_audio_summary_created_at ON audio_summary FIELDS created_at;
INFO FOR TABLE audio_summary;
