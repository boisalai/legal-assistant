#V2
SELECT * FROM course ORDER BY pinned DESC, created_at DESC;
SELECT count() as total FROM course GROUP ALL;
INFO FOR ROOT;
SELECT count() as total FROM course GROUP ALL;
SELECT id, title, course_code, created_at FROM course ORDER BY created_at DESC;
SELECT count() as total FROM course GROUP ALL;
SELECT count() FROM document GROUP ALL;
SELECT count() FROM course GROUP ALL; SELECT count() FROM embedding_chunk GROUP ALL;
SELECT * FROM course;
SELECT * FROM document WHERE course_id = course:94921feb;
SELECT * FROM course;
SELECT * FROM user;
SELECT id, filename, linked_source FROM document WHERE id = type::thing('document', 'a8052fa4');
SELECT id, filename FROM document LIMIT 5;
INFO FOR DB;
SELECT id, filename FROM document LIMIT 3;
-- Définition de la table flashcard_deck
DEFINE TABLE flashcard_deck SCHEMAFULL;
DEFINE FIELD course_id ON flashcard_deck TYPE string;
DEFINE FIELD name ON flashcard_deck TYPE string;
DEFINE FIELD source_documents ON flashcard_deck TYPE array;
DEFINE FIELD card_types ON flashcard_deck TYPE array;
DEFINE FIELD card_count_requested ON flashcard_deck TYPE int DEFAULT 50;
DEFINE FIELD created_at ON flashcard_deck TYPE datetime DEFAULT time::now();
DEFINE FIELD last_studied ON flashcard_deck TYPE option<datetime>;
DEFINE INDEX idx_flashcard_deck_course ON flashcard_deck FIELDS course_id;
-- Définition de la table flashcard
DEFINE TABLE flashcard SCHEMAFULL;
DEFINE FIELD deck_id ON flashcard TYPE string;
DEFINE FIELD document_id ON flashcard TYPE string;
DEFINE FIELD card_type ON flashcard TYPE string;
DEFINE FIELD front ON flashcard TYPE string;
DEFINE FIELD back ON flashcard TYPE string;
DEFINE FIELD source_excerpt ON flashcard TYPE option<string>;
DEFINE FIELD source_location ON flashcard TYPE option<string>;
DEFINE FIELD status ON flashcard TYPE string DEFAULT "new";
DEFINE FIELD review_count ON flashcard TYPE int DEFAULT 0;
DEFINE FIELD last_reviewed ON flashcard TYPE option<datetime>;
DEFINE FIELD created_at ON flashcard TYPE datetime DEFAULT time::now();
DEFINE INDEX idx_flashcard_deck ON flashcard FIELDS deck_id;
DEFINE INDEX idx_flashcard_status ON flashcard FIELDS deck_id, status;
-- Vérifier
INFO FOR TABLE flashcard_deck;
DEFINE TABLE flashcard_deck SCHEMAFULL;
DEFINE FIELD course_id ON flashcard_deck TYPE string;
DEFINE FIELD name ON flashcard_deck TYPE string;
DEFINE FIELD source_documents ON flashcard_deck TYPE array;
DEFINE FIELD card_types ON flashcard_deck TYPE array;
DEFINE FIELD card_count_requested ON flashcard_deck TYPE int DEFAULT 50;
DEFINE FIELD created_at ON flashcard_deck TYPE datetime DEFAULT time::now();
DEFINE FIELD last_studied ON flashcard_deck TYPE option<datetime>;
DEFINE INDEX idx_flashcard_deck_course ON flashcard_deck FIELDS course_id;
DEFINE TABLE flashcard SCHEMAFULL;
DEFINE FIELD deck_id ON flashcard TYPE string;
DEFINE FIELD document_id ON flashcard TYPE string;
DEFINE FIELD card_type ON flashcard TYPE string;
DEFINE FIELD front ON flashcard TYPE string;
DEFINE FIELD back ON flashcard TYPE string;
DEFINE FIELD source_excerpt ON flashcard TYPE option<string>;
DEFINE FIELD source_location ON flashcard TYPE option<string>;
DEFINE FIELD status ON flashcard TYPE string DEFAULT "new";
DEFINE FIELD review_count ON flashcard TYPE int DEFAULT 0;
DEFINE FIELD last_reviewed ON flashcard TYPE option<datetime>;
DEFINE FIELD created_at ON flashcard TYPE datetime DEFAULT time::now();
DEFINE INDEX idx_flashcard_deck ON flashcard FIELDS deck_id;
DEFINE INDEX idx_flashcard_status ON flashcard FIELDS deck_id, status;
INFO FOR TABLE flashcard_deck;
SELECT * FROM flashcard_deck;
SELECT * FROM flashcard_deck WHERE course_id = type::thing('course', 'd377f2b5') ORDER BY created_at DESC;
SELECT course_id FROM flashcard_deck:0081bf40;
UPDATE flashcard_deck:d9e1abbd SET   source_documents = [{"doc_id": "document:004e13d2", "name": "module-8.md"}],  card_types = ["definition", "concept"];
SELECT source_documents, card_types FROM flashcard_deck:d9e1abbd;
-- Supprimer les anciennes tables
REMOVE TABLE flashcard_deck;
REMOVE TABLE flashcard;
-- Recréer sans SCHEMAFULL (schemaless)
DEFINE TABLE flashcard_deck SCHEMALESS;
DEFINE TABLE flashcard SCHEMALESS;
-- Créer les index
DEFINE INDEX idx_flashcard_deck_course ON flashcard_deck FIELDS course_id;
DEFINE INDEX idx_flashcard_deck ON flashcard FIELDS deck_id;
DEFINE INDEX idx_flashcard_status ON flashcard FIELDS deck_id, status;
INFO FOR TABLE flashcard_deck;
SELECT * FROM flashcard LIMIT 3;
SELECT id, filename, file_path, linked_source, extracted_text FROM document WHERE id IN [  type::thing('document', '6eba1c03'),  type::thing('document', '924b0dbd'),  type::thing('document', '575c1e1f')];
SELECT * FROM flashcard_deck LIMIT 5;
SELECT id, front, back, card_type FROM flashcard WHERE deck_id = "flashcard_deck:cda12f51";
DELETE flashcard WHERE deck_id = "flashcard_deck:cda12f51";
SELECT * FROM flashcard_deck LIMIT 1;
SELECT id, card_type, front, back FROM flashcard WHERE deck_id = "flashcard_deck:8004be94" LIMIT 5;
SELECT * FROM flashcard_deck:8004be94;
SELECT id, name, card_count_requested FROM flashcard_deck:96b2c0f4;
DELETE flashcard WHERE deck_id IN ["flashcard_deck:8004be94", "flashcard_deck:96b2c0f4"];
DELETE flashcard_deck:8004be94;
DELETE flashcard_deck:96b2c0f4;
SELECT count() FROM flashcard_deck;
DELETE flashcard WHERE deck_id = "flashcard_deck:d93c545c";
UPDATE flashcard_deck:d93c545c SET card_count_requested = 20;
SELECT id, course_id, filename, linked_source.link_id, linked_source.base_path FROM document WHERE source_type = 'linked' AND linked_source.base_path CONTAINS 'DRT' LIMIT 5;
SELECT id, email, role, actif FROM user LIMIT 10;
